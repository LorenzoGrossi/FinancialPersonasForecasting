knitr::opts_chunk$set(echo = TRUE)
library(corrplot) # Per visualizzare la matrice di correlazione come una heatmap
library(ggplot2) # Per i grafici
library(caret) # Per l'addestramento dei modelli di machine learning
library(R.matlab)
library(readxl)
# Pacchetti per Machine Learning
library(e1071) # Per il classificatore SVM
library(caTools)
library(caret)
library(class)
# Outlier
library(MASS)
library(rgl)
library(DepthProc)
library(hexbin)
library(aplpack)
library(robustbase)
# Import
BankClients <- read_excel("/Users/Lorenzo/Desktop/Tesi/BankClients.xlsx")
# Import
BankClients <- read_excel("/Users/Lorenzo/Desktop/Tesi/Functions&Data/BankClients.xlsx")
#summary(BankClients)
# Visualizza le dipendenze delle variabili numeriche
Datatoplot <- BankClients[7:17]
Datatoplot <- cbind(Age=BankClients$Age, Datatoplot)
xnames <- c("Age", "familysize", "income", "wealth", "debt", "finedu", "esg", "digital", "bankfriend", "lifestyle", "luxury", "savings")
#tukey_depth=depth(u=Datatoplot,method='Tukey')
#maha_depth=depth(Datatoplot,method='Mahalanobis')
#summary(maha_depth)
columns_to_plot <- Datatoplot[, c(1,6,8,10)]
bagplot_matrix <- aplpack::bagplot.pairs(columns_to_plot, col.baghull="green", col.loophull="lightgreen",main="Bagplot of some pairs of variables")
# Ho provato tutte le coppie di variabili; trovo outliers nei bagplot tra
# 1:6, 1:12
# 3:6, 3:7, 3:8, 3:9
# 4:10
# 5:8, 5:12
# 6:7, 6:8, 6:10, 6:12
#fino a qua sono: 2218 4346 4641 4926  782 3564 1099   16   62  341 1446 2167 3074 3759 4488
#       2296 1722 2766  373 2052 2159 3686 3690  111  347 1134 1260
#     1277 2048 2218 2917 3030 3173 3756 4694  543 2054 2064 2218  373 2159 2180 2861 3690 4273
# 7:8, 7:9, 7:10
# 8:9, 8:10, 8:11, 8:12
# metto vuoto il vettore e lo priempio a mano a mano per ogni copia di variabili con outliers
all_outliers<-c()
# qui ho variato tutte le copie che ho messo nella tabella sopra questa, e le ho aggiunte al vettore con tutti gli outliers
bagplot_result <- bagplot(Datatoplot$FinEdu, Datatoplot$Digital)
out <- bagplot_result$pxy.outlier
selected_out <- subset(BankClients, FinEdu == out[1,1] & Digital == out[1,2])$ID
#all_out_old<-all_outliers
#all_outliers<-c(all_out_old, selected_out)
